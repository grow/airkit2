!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(t){return e[t]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t){"use strict";function n(e,t){for(var n,o=0;o<t.length;o++)(n=t[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}var o=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.element=t,this.options=n}return function(e,t,o){t&&n(e.prototype,t),o&&n(e,o)}(e,[{key:"init",value:function(){this.element.setAttribute("ak-init","true")}},{key:"destroy",value:function(){this.element.removeAttribute("ak-init"),this.element=null,this.options=null}}]),e}();t.a=o},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n,o=0;o<t.length;o++)(n=t[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n(0);var a=function(){function e(){var t=this;o(this,e),this.observer=new MutationObserver((function(){return t.updateComponents()})),this.handlers=[]}return i(e,[{key:"register",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return this.handlers.push(new u(e,t,n||{})),this}},{key:"run",value:function(){this.updateComponents(),this.observer.observe(document.body,{attributes:!0,attributeFilter:["class"],childList:!0,subtree:!0})}},{key:"destroy",value:function(){this.handlers.forEach((function(e){return e.destroy()})),this.handlers=[],this.observer.disconnect()}},{key:"updateComponents",value:function(){this.handlers.forEach((function(e){return e.updateComponents()}))}}]),e}(),u=function(){function e(t,n,r){o(this,e),this.nodeList=document.getElementsByClassName(t),this.componentCtor=n,this.options=r,this.components={},this.nextId_=1}return i(e,[{key:"updateComponents",value:function(){for(var e,t=this,n=new Set,o=0;e=this.nodeList[o];o++){if(!e.akId){var r=new this.componentCtor(e,this.options);e.akId=this.nextId_++,e.component=r,r.init(),this.components[e.akId]=r}n.add(e.akId)}Object.values(this.components).filter((function(e){return!n.has(e.element.akId)})).forEach((function(e){t.destroyComponent_(e)}))}},{key:"destroy",value:function(){var e=this;Object.values(this.components).forEach((function(t){e.destroyComponent_(t)})),this.nodeList=null,this.components=null}},{key:"destroyComponent_",value:function(e){delete this.components[e.element.akId],e.element.akId=null,e.element.akComponent=null,e.destroy()}}]),e}();t.a=a},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n,o=0;o<t.length;o++)(n=t[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=c(e);if(t){var r=c(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return l}));var l=function(e){function t(e,o){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i={};return(r=n.call(this,e,o)).options.rootMargin&&(i.rootMargin=r.options.rootMargin),r.options.threshold&&(i.threshold=r.options.threshold),r.observer=new IntersectionObserver((function(e){r.handleIntersect_(e)}),i),r}!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,e);var n=u(t);return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(t,[{key:"init",value:function(){i(c(t.prototype),"init",this).call(this),this.observer.observe(this.element)}},{key:"destroy",value:function(){i(c(t.prototype),"destroy",this).call(this),this.observer.disconnect(),this.observer=null}},{key:"handleIntersect_",value:function(e){var t=e[0].isIntersecting;this.handleInview_(t)}},{key:"handleInview_",value:function(e){this.options.inviewClass&&this.element.classList.toggle(this.options.inviewClass,e)}}]),t}(n(0).a);t.b=l},,function(e,t,n){"use strict";function o(e,t){for(var n,o=0;o<t.length;o++)(n=t[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n,o=0;o<t.length;o++)(n=t[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.r(t);var f=n(1),d=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.promises={}}return function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(e,[{key:"load",value:function(e){var t=this;if(this.promises[e])return this.promises[e];var n=new Promise((function(t,n){var o=new Image;o.addEventListener("load",(function(){t(e)}),{once:!0}),o.addEventListener("error",(function(){n("failed to load image")})),o.src=e}));return this.promises[e]=n,n.catch((function(n){console.error(n),delete t.promises[e]})),n}},{key:"wait",value:function(){return Promise.all(Object.values(this.promises))}}]),e}(),h=function(e){function t(e,o){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=n.call(this,e,o)).imageLoader=new d,r.loading=!1,r.loaded=!1,r.resizeListener_=null,r}!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e);var n=s(t);return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"init",value:function(){var e=this;this.resizeListener_=function(e,t){var n=null;return function(){for(var o=arguments.length,r=Array(o),i=0;i<o;i++)r[i]=arguments[i];n&&clearTimeout(n),n=setTimeout((function(){e.apply(void 0,r)}),t)}}((function(){return e.onResize_()}),500),window.addEventListener("resize",this.resizeListener_),a(l(t.prototype),"init",this).call(this)}},{key:"destroy",value:function(){window.removeEventListener("resize",this.resizeListener_),this.imageLoader=null,a(l(t.prototype),"destroy",this).call(this)}},{key:"handleInview_",value:function(e){a(l(t.prototype),"handleInview_",this).call(this,e),!e||this.loading||this.loaded||this.loadImages_()}},{key:"onResize_",value:function(){var e=this;this.loaded=!1,this.getImgElements_().filter((function(t){return e.isImageLoaded_(t)})).forEach((function(t){return e.loadImgElement_(t)})),this.getBackgroundImageElements_().filter((function(t){return e.isImageLoaded_(t)})).forEach((function(t){return e.loadBackgroundImageElement_(t)}))}},{key:"loadImages_",value:function(){var e=this;this.loading=!0,this.getImgElements_().filter((function(t){return e.isElementVisisble_(t)&&!e.isImageLoaded_(t)})).forEach((function(t){return e.loadImgElement_(t)})),this.getBackgroundImageElements_().filter((function(t){return e.isElementVisisble_(t)&&!e.isImageLoaded_(t)})).forEach((function(t){return e.loadBackgroundImageElement_(t)})),this.imageLoader.wait().then((function(){e.loading=!1,e.options.loadedClass&&e.element.classList.add(e.options.loadedClass)}))}},{key:"getImgElements_",value:function(){var e=[].slice.call(this.element.querySelectorAll("[lazyimage-src]"));return this.element.hasAttribute("lazyimage-src")&&e.push(this.element),e}},{key:"loadImgElement_",value:function(e){var t=this,n=e.getAttribute("lazyimage-src"),o=this.formatSrc_(e,n);return e.src===o?void this.setImageLoaded_(e,!0):void this.imageLoader.load(o).then((function(){e.src=o,t.setImageLoaded_(e,!0)}))}},{key:"getBackgroundImageElements_",value:function(){var e=[].slice.call(this.element.querySelectorAll("[lazyimage-background-image]"));return this.element.hasAttribute("lazyimage-background-image")&&e.push(this.element),e}},{key:"loadBackgroundImageElement_",value:function(e){var t=this,n=e.getAttribute("lazyimage-background-image"),o=this.formatSrc_(e,n),r="url(".concat(o,")");return e.style.backgroundImage===r?void this.setImageLoaded_(e,!0):void this.imageLoader.load(o).then((function(){e.style.backgroundImage="url(".concat(o,")"),t.setImageLoaded_(e,!0)}))}},{key:"formatSrc_",value:function(e,t){return t.replace(/\{[a-z]*\}/g,(function(t){var n=Math.max;if("{width}"==t){var o=e.akLazyImageLoadedWidth||0,r=Math.ceil(e.offsetWidth*window.devicePixelRatio),i=n(o,r);return e.akLazyImageLoadedWidth=i,n(o,r)}return t}))}},{key:"isImageLoaded_",value:function(e){return!!e.akLazyImageLoaded}},{key:"setImageLoaded_",value:function(e,t){e.akLazyImageLoaded=t,t&&e.setAttribute("lazyimage-loaded","true")}},{key:"isElementVisisble_",value:function(e){return null!==e.offsetParent}}]),t}(n(2).a),p=new f.a;p.register("lazyimage",h,{inviewClass:"lazyimage--visible",loadedClass:"lazyimage--loaded"}),document.addEventListener("DOMContentLoaded",(function(){p.run()}))}]);